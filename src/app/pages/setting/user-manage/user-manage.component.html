<nz-card class="list" nzTitle="角色列表">
  <div class="list-action">
    <nz-input-group [nzSuffix]="usernameSuffixTemplate">
      <input type="text" nz-input [(ngModel)]="username" placeholder="用户名称"/>
    </nz-input-group>
    <nz-select [(ngModel)]="sexSelected" style="min-width: 200px">
      <nz-option [nzLabel]="'男'" [nzValue]="1"></nz-option>
      <nz-option [nzLabel]="'女'" [nzValue]="2"></nz-option>
      <nz-option [nzLabel]="'保密'" [nzValue]="0"></nz-option>
    </nz-select>
    <button nz-button nzType="default" (click)="search()"><i nz-icon nzType="search"></i>查询</button>
    <button nz-button nzType="primary" (click)="addModalShow()"><i nz-icon type="plus"></i>新增</button>
    <button nz-button nzType="danger"><i nz-icon type="delete"></i>删除</button>
    <button nz-button nzType="default"><i nz-icon nzType="export" nzTheme="outline"></i>导出</button>
  </div>
  <!--<div class="list-table">
    <nz-table
      #userTable
      nzShowPagination
      nzShowSizeChanger
      nzBordered
      [nzFrontPagination]="false"
      [nzData]="listOfAllData"
      [nzLoading]="loading"
      [nzTotal]="total"
      [(nzPageIndex)]="pageIndex"
      [(nzPageSize)]="pageSize"
      (nzPageIndexChange)="search()"
      (nzPageSizeChange)="search(true)"
      (nzCurrentPageDataChange)="currentPageDataChange($event)"
    >
      <thead>
      <tr>
        <th
          nzShowCheckbox
          [(nzChecked)]="isAllDisplayDataChecked"
          [nzIndeterminate]="isIndeterminate"
          (nzCheckedChange)="checkAll($event)"
        ></th>
        <th nzWidth="30%" nzAlign="center">名称</th>
        <th nzWidth="30%" nzAlign="center">备注</th>
        <th nzWidth="20%" nzAlign="center"
            nzShowSort
        >
          创建时间
        </th>
        <th nzWidth="20%" nzAlign="center">操作</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let data of roleTable.data">
        <td
          nzShowCheckbox
          [(nzChecked)]="mapOfCheckedId[data.id]"
          [nzDisabled]="data.disabled"
          (nzCheckedChange)="refreshStatus()"
        ></td>
        <td nzAlign="center">{{ data.roleName }}</td>
        <td nzAlign="center">{{ data.description }}</td>
        <td nzAlign="center">{{ data.dateCreated }}</td>
        <td nzAlign="center">
          <a (click)="editRole(data.id)">编辑</a>
          <nz-divider nzType="vertical"></nz-divider>
          <a (click)="delRoleSingle(data.id)">删除</a>
        </td>
      </tr>
      </tbody>
    </nz-table>
  </div>-->
</nz-card>

<ng-template #usernameSuffixTemplate
><i
  nz-icon
  nz-tooltip
  class="ant-input-clear-icon"
  nzTheme="fill"
  nzType="close-circle"
  *ngIf="username"
  (click)="username = null"
></i
></ng-template>

<!--新增、编辑角色-->
<nz-modal *ngIf="isShowAddOrEditModal"
          [(nzVisible)]="isShowAddOrEditModal"
          nzWidth="800"
          [nzTitle]="modalType === 1 ? '新增' : '修改'"
          (nzOnCancel)="handleCancel(modalType)"
          (nzOnOk)="handleOk(modalType, addOrEditForm.value)"
          [nzOkLoading]="isModalOkLoading">

  <form nz-form [formGroup]="addOrEditForm">
    <nz-form-item>
      <nz-form-label [nzSm]="4" [nzXs]="24" nzFor="username" nzRequired>用户名</nz-form-label>
      <nz-form-control [nzSm]="10" [nzXs]="24" nzHasFeedback nzValidatingTip="检查用户名..." [nzErrorTip]="userErrorTpl">
        <input nz-input formControlName="username" placeholder="用户名" />
        <ng-template #userErrorTpl let-control>
          <ng-container *ngIf="control.hasError('required')">
            请输入用户名!
          </ng-container>
          <ng-container *ngIf="control.hasError('duplicated')">
            用户名已存在!
          </ng-container>
        </ng-template>
      </nz-form-control>
    </nz-form-item>
    <!--部门-->
    <nz-form-item>
      <nz-form-label [nzSm]="4" [nzXs]="24" nzFor="dept" nzRequired>所属部门</nz-form-label>
      <nz-form-control [nzSm]="10" [nzXs]="24">
        <nz-input-group nzSearch [nzAddOnAfter]="suffixIconSearchDeptButton">
          <input nz-input id="dept" formControlName="dept"
                 placeholder="选择部门"/>
        </nz-input-group>
        <nz-form-explain *ngIf="addOrEditForm.get('dept')?.dirty && addOrEditForm.get('dept')?.errors">请选择部门</nz-form-explain>
      </nz-form-control>
    </nz-form-item>
    <!--密码-->
    <nz-form-item>
      <nz-form-label [nzSm]="4" [nzXs]="24" nzRequired>密码</nz-form-label>
      <div>
        <nz-form-control [nzSm]="10" [nzXs]="24" nzHasFeedback nzErrorTip="请输入密码!">
          <input nz-input type="password" formControlName="password" (ngModelChange)="validateConfirmPassword()" placeholder="密码"/>
        </nz-form-control>
      </div>
    </nz-form-item>
    <nz-form-item>
      <nz-form-label [nzSm]="4" [nzXs]="24" nzRequired>确认密码</nz-form-label>
      <nz-form-control [nzSm]="10" [nzXs]="24" nzHasFeedback [nzErrorTip]="passwordErrorTpl">
        <input nz-input type="password" formControlName="confirm" placeholder="确认密码" />
        <ng-template #passwordErrorTpl let-control>
          <ng-container *ngIf="control.hasError('required')">
            请再次输入密码!
          </ng-container>
          <ng-container *ngIf="control.hasError('confirm')">
            确认密码和密码不一致!
          </ng-container>
        </ng-template>
      </nz-form-control>
    </nz-form-item>
    <!--性别-->
    <nz-form-item>
      <nz-form-label [nzSm]="4" [nzXs]="24">性别</nz-form-label>
      <nz-form-control [nzSm]="10" [nzXs]="24">
        <nz-radio-group formControlName="sex" [(ngModel)]="sexRadioValue">
          <label nz-radio nzValue="1">男</label>
          <label nz-radio nzValue="2">女</label>
          <label nz-radio nzValue="0">保密</label>
        </nz-radio-group>
      </nz-form-control>
    </nz-form-item>
    <!--email-->
    <nz-form-item>
      <nz-form-label [nzSm]="4" [nzXs]="24">邮箱</nz-form-label>
      <nz-form-control [nzSm]="10" [nzXs]="24" nzHasFeedback [nzErrorTip]="emailErrorTpl">
        <input nz-input formControlName="email" placeholder="电子邮箱" type="email" />
        <ng-template #emailErrorTpl let-control>
          <ng-container *ngIf="control.hasError('email')">
            电子邮箱格式错误!
          </ng-container>
        </ng-template>
      </nz-form-control>
    </nz-form-item>
    <!--手机号码-->
    <nz-form-item>
      <nz-form-label [nzSm]="4" [nzXs]="24">手机号码</nz-form-label>
      <nz-form-control [nzSm]="10" [nzXs]="24">
        <input nz-input id="mobile" formControlName="mobile" placeholder="11位手机号码"/>
      </nz-form-control>
    </nz-form-item>
    <!--角色-->
    <nz-form-item>
      <nz-form-label [nzSm]="4" [nzXs]="24">角色配置</nz-form-label>
      <nz-form-control [nzSm]="10" [nzXs]="24">
        <nz-select id="role" formControlName="role" [ngModel]="1">
          <nz-option nzLabel="管理员" nzValue="1"></nz-option>
        </nz-select>
      </nz-form-control>
    </nz-form-item>
    <!--用户状态-->
    <nz-form-item>
      <nz-form-label [nzSm]="4" [nzXs]="24">状态</nz-form-label>
      <nz-form-control [nzSm]="10" [nzXs]="24">
        <nz-radio-group formControlName="status" [(ngModel)]="status">
          <label nz-radio nzValue="-1">停用</label>
          <label nz-radio nzValue="1">正常</label>
        </nz-radio-group>
      </nz-form-control>
    </nz-form-item>
  </form>
</nz-modal>

<ng-template #suffixIconSearchDeptButton>
  <button nz-button nzType="primary" nzSearch><i nz-icon nzType="search"></i></button>
</ng-template>
